<?xml version="1.0" encoding="UTF-8"?>

<?import java.net.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.text.*?>

<HBox fx:id="salesManagerDashboardPane" alignment="CENTER" styleClass="dashboard-grid" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="controllers.salesController.DashboardController">
    <stylesheets>
        <URL value="@../css/sales-manager.css" />
    </stylesheets>
    <ScrollPane fitToWidth="true" styleClass="dashboard-scroll-pane" HBox.hgrow="ALWAYS">
        <VBox fx:id="mainContainer" alignment="CENTER" spacing="15.0" styleClass="main-container">
            <HBox fx:id="headerBox" alignment="CENTER_LEFT" spacing="20" styleClass="header-box">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <ImageView fitHeight="32" fitWidth="32" preserveRatio="true">
                        <Image url="@../images/user.png" />
                    </ImageView>
                    <Text fx:id="welcomeText" styleClass="welcome-text" text="Welcome back">
                    <font>
                       <Font size="18.0" />
                        </font>
                    </Text>
                </HBox>
                <Region HBox.hgrow="ALWAYS" />
                <StackPane alignment="CENTER_RIGHT">
                    <Button fx:id="btnNotifications" styleClass="icon-button">
                        <graphic>
                            <ImageView fitHeight="24" fitWidth="24" preserveRatio="true">
                                <Image url="@../images/notification.png" />
                            </ImageView>
                        </graphic>
                    </Button>
                    <Circle fx:id="notificationBadge" radius="5" styleClass="notification-badge">
                        <StackPane.margin>
                            <Insets right="-8" top="-8" />
                        </StackPane.margin>
                    </Circle>
                </StackPane>
            </HBox>

                        <!-- Filter Section -->
            <HBox spacing="15" styleClass="filter-container">
                <Region HBox.hgrow="ALWAYS" />
                <Button fx:id="btnExport" onAction="#handleExport" styleClass="action-button">
                    <graphic>
                        <HBox alignment="CENTER" spacing="5">
                            <ImageView fitHeight="16" fitWidth="16">
                                <Image url="@../images/export.png" />
                            </ImageView>
                            <Label text="Export" />
                </HBox>
                    </graphic>
                </Button>
            </HBox>

                        <!-- KPI Cards -->
            <HBox spacing="20" styleClass="kpi-container">
                <VBox styleClass="kpi-card">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <ImageView fitHeight="24" fitWidth="24">
                            <Image url="@../images/money.png" />
                        </ImageView>
                        <VBox>
                            <Label fx:id="lblTotalRevenue" styleClass="kpi-value" />
                            <Label styleClass="kpi-label" text="Total Revenue" />
                        </VBox>
                    </HBox>
                    <ProgressBar fx:id="revenueProgress" styleClass="kpi-progress" />
                </VBox>

                            <VBox styleClass="kpi-card">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <ImageView fitHeight="24" fitWidth="24">
                            <Image url="@../images/profit.png" />
                        </ImageView>
                        <VBox>
                            <Label fx:id="lblTotalProfit" styleClass="kpi-value" />
                            <Label styleClass="kpi-label" text="Total Profit" />
                        </VBox>
                    </HBox>
                    <ProgressBar fx:id="profitProgress" styleClass="kpi-progress" />
                </VBox>

                <VBox styleClass="kpi-card">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <ImageView fitHeight="24" fitWidth="24">
                            <Image url="@../images/cart.png" />
                        </ImageView>
                        <VBox>
                            <Label fx:id="lblTotalOrders" styleClass="kpi-value" />
                            <Label styleClass="kpi-label" text="Total Orders" />
                        </VBox>
                    </HBox>
                    <ProgressBar fx:id="ordersProgress" styleClass="kpi-progress" />
                </VBox>

                <VBox styleClass="kpi-card">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <ImageView fitHeight="24" fitWidth="24">
                            <Image url="@../images/chart.png" />
                        </ImageView>
                        <VBox>
                            <Label fx:id="lblProfitMargin" styleClass="kpi-value" />
                            <Label styleClass="kpi-label" text="Profit Margin" />
                        </VBox>
                    </HBox>
                    <ProgressBar fx:id="marginProgress" styleClass="kpi-progress" />
                </VBox>

                <VBox styleClass="kpi-card">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <ImageView fitHeight="24" fitWidth="24">
                            <Image url="@../images/supplier.png" />
                        </ImageView>
                        <VBox>
                            <Label fx:id="lblSupplierCount" styleClass="kpi-value" />
                            <Label styleClass="kpi-label" text="Active Suppliers" />
                        </VBox>
                    </HBox>
                    <ProgressBar fx:id="supplierProgress" styleClass="kpi-progress" />
                </VBox>
            </HBox>

                        <!-- Charts Grid -->
            <GridPane hgap="20" vgap="20">
                          <columnConstraints>
                              <ColumnConstraints percentWidth="50" />
                              <ColumnConstraints percentWidth="50" />
                          </columnConstraints>
          
                            <!-- Revenue & Profit Trend -->
                          <VBox styleClass="chart-container" GridPane.columnIndex="0" GridPane.rowIndex="0">
                    <Label styleClass="chart-title" text="Revenue &amp; Profit Trend" />
                    <StackedAreaChart fx:id="trendChart">
                                  <xAxis>
                            <CategoryAxis label="Date" />
                                  </xAxis>
                                  <yAxis>
                            <NumberAxis label="Amount ($)" />
                                  </yAxis>
                    </StackedAreaChart>
                          </VBox>
          
                            <!-- Low Stock Alert Chart -->
                          <VBox styleClass="chart-container" GridPane.columnIndex="1" GridPane.rowIndex="0">
                    <Label styleClass="chart-title" text="Inventory Alerts">
                        <graphic>
                            <ImageView fitHeight="24" fitWidth="24">
                                <Image url="@../images/warning.png" />
                            </ImageView>
                        </graphic>
                    </Label>
                    <BarChart fx:id="lowStockChart" animated="false" legendSide="TOP" legendVisible="true">
                                  <xAxis>
                            <CategoryAxis animated="false" label="Item Name" tickLabelRotation="45" />
                                  </xAxis>
                                  <yAxis>
                            <NumberAxis animated="false" label="Current Stock" minorTickCount="0" tickUnit="1" />
                                  </yAxis>
                    </BarChart>
                    <HBox alignment="CENTER_RIGHT" spacing="10" styleClass="chart-footer">
                        <Label fx:id="lowStockCountLabel" alignment="CENTER" contentDisplay="CENTER" styleClass="alert-count" textAlignment="CENTER" />
                    </HBox>
                </VBox>

                            <!-- Daily Orders Distribution -->
                <VBox styleClass="chart-container" GridPane.columnIndex="0" GridPane.rowIndex="1">
                    <Label styleClass="chart-title" text="Daily Orders Distribution" />
                    <PieChart fx:id="ordersChart" labelsVisible="true" />
                          </VBox>
          
                          <!-- Revenue Analysis -->
                <VBox styleClass="chart-container" GridPane.columnIndex="1" GridPane.rowIndex="1">
                              <Label styleClass="chart-title" text="Revenue Analysis" />
                    <LineChart fx:id="revenueAnalysisChart">
                                  <xAxis>
                                      <CategoryAxis label="Date" />
                                  </xAxis>
                                  <yAxis>
                                      <NumberAxis label="Amount ($)" />
                                  </yAxis>
                              </LineChart>
                          </VBox>
            <rowConstraints>
               <RowConstraints />
               <RowConstraints />
            </rowConstraints>
                      </GridPane>
        </VBox>
    </ScrollPane>
</HBox>
